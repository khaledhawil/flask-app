{% extends "base.html" %}

{% block title %}التطبيق الإسلامي الشامل - Islamic App{% endblock %}

{% block styles %}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&family=Scheherazade+New:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap');
    
    :root {
        --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --gradient-warning: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        --gradient-islamic: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        --shadow-soft: 0 10px 40px rgba(0, 0, 0, 0.1);
        --shadow-medium: 0 20px 60px rgba(0, 0, 0, 0.15);
        --shadow-strong: 0 30px 80px rgba(0, 0, 0, 0.2);
        --border-radius-sm: 12px;
        --border-radius-md: 16px;
        --border-radius-lg: 24px;
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;
    }

    /* Enhanced Background with Animated Islamic Pattern */
    .islamic-pattern {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, 
            rgba(102, 126, 234, 0.02) 0%, 
            rgba(118, 75, 162, 0.02) 25%,
            rgba(255, 215, 0, 0.01) 50%,
            rgba(102, 126, 234, 0.02) 75%,
            rgba(118, 75, 162, 0.02) 100%
        );
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
        z-index: -2;
    }

    .islamic-pattern::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
            radial-gradient(circle at 20% 20%, rgba(255,215,0,0.06) 2px, transparent 2px),
            radial-gradient(circle at 80% 80%, rgba(102, 126, 234, 0.04) 3px, transparent 3px),
            radial-gradient(circle at 40% 60%, rgba(118, 75, 162, 0.03) 1px, transparent 1px);
        background-size: 100px 100px, 150px 150px, 80px 80px;
        animation: patternFloat 20s linear infinite;
    }

    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    @keyframes patternFloat {
        0% { transform: translateX(0) translateY(0); }
        33% { transform: translateX(30px) translateY(-30px); }
        66% { transform: translateX(-20px) translateY(20px); }
        100% { transform: translateX(0) translateY(0); }
    }

    /* Modern Hadith Banner */
    .hadith-banner {
        background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.95) 0%, 
            rgba(255, 255, 255, 0.9) 100%
        );
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: var(--border-radius-lg);
        margin: var(--spacing-lg) auto;
        padding: var(--spacing-xl);
        text-align: center;
        max-width: 1000px;
        box-shadow: var(--shadow-medium);
        position: relative;
        overflow: hidden;
        transition: all 0.4s ease;
    }

    .hadith-banner:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-strong);
    }

    .hadith-banner::before {
        content: "﷽";
        position: absolute;
        top: -20px;
        right: -20px;
        font-size: 6rem;
        background: var(--gradient-islamic);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        opacity: 0.15;
        animation: pulse 4s ease-in-out infinite;
    }

    .hadith-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--gradient-islamic);
        opacity: 0.05;
        z-index: -1;
    }

    @keyframes pulse {
        0%, 100% { opacity: 0.15; transform: scale(1); }
        50% { opacity: 0.25; transform: scale(1.05); }
    }

    .hadith-content {
        direction: rtl;
        text-align: center;
        position: relative;
        z-index: 1;
    }

    .hadith-arabic {
        font-family: 'Amiri', serif;
        font-size: 1.8rem;
        line-height: 2;
        background: linear-gradient(135deg, #2c3e50, #34495e);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        margin-bottom: var(--spacing-md);
        font-weight: 700;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .hadith-translation {
        font-family: 'Inter', sans-serif;
        font-size: 1.2rem;
        color: #6b7280;
        font-style: italic;
        margin-bottom: var(--spacing-sm);
        direction: ltr;
        line-height: 1.6;
    }

    .hadith-narrator {
        font-family: 'Cairo', sans-serif;
        font-size: 1rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    /* Modern Hero Section */
    .hero-section {
        text-align: center;
        padding: var(--spacing-xl) var(--spacing-sm);
        margin: var(--spacing-lg) 0;
        position: relative;
        overflow: hidden;
    }

    .hero-section::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
        transform: translate(-50%, -50%);
        animation: heroGlow 8s ease-in-out infinite;
        z-index: -1;
    }

    @keyframes heroGlow {
        0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
        50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
    }

    .hero-title {
        font-family: 'Amiri', serif;
        font-size: clamp(2.5rem, 5vw, 4rem);
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        margin-bottom: var(--spacing-md);
        font-weight: 700;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        animation: titleFloat 6s ease-in-out infinite;
    }

    @keyframes titleFloat {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    .hero-subtitle {
        font-family: 'Inter', sans-serif;
        font-size: clamp(1.1rem, 2.5vw, 1.4rem);
        color: #6b7280;
        margin-bottom: var(--spacing-xl);
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
        line-height: 1.7;
        font-weight: 400;
        opacity: 0;
        animation: fadeInUp 1s ease 0.5s forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Ultra-Modern Feature Grid */
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: var(--spacing-xl);
        margin: var(--spacing-xl) 0;
        padding: 0 var(--spacing-sm);
    }

    .feature-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-xl);
        text-align: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transform-origin: center;
    }

    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.6s ease;
    }

    .feature-card:hover::before {
        left: 100%;
    }

    .feature-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: var(--primary-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }

    .feature-icon {
        font-size: 3rem;
        margin-bottom: var(--spacing-md);
        display: inline-block;
        transition: all 0.4s ease;
    }

    .feature-card:hover .feature-icon {
        transform: scale(1.1) rotate(5deg);
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
    }

    /* Modern Hero Section */
    .hero-section {
        text-align: center;
        padding: var(--spacing-xl) var(--spacing-sm);
        margin: var(--spacing-lg) 0;
        position: relative;
        overflow: hidden;
    }

    .hero-section::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
        transform: translate(-50%, -50%);
        animation: heroGlow 8s ease-in-out infinite;
        z-index: -1;
    }

    @keyframes heroGlow {
        0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
        50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
    }

    .hero-title {
        font-family: 'Amiri', serif;
        font-size: clamp(2.5rem, 5vw, 4rem);
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        margin-bottom: var(--spacing-md);
        font-weight: 700;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        animation: titleFloat 6s ease-in-out infinite;
    }

    @keyframes titleFloat {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    .hero-subtitle {
        font-family: 'Inter', sans-serif;
        font-size: clamp(1.1rem, 2.5vw, 1.4rem);
        color: #6b7280;
        margin-bottom: var(--spacing-xl);
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
        line-height: 1.7;
        font-weight: 400;
        opacity: 0;
        animation: fadeInUp 1s ease 0.5s forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Ultra-Modern Feature Grid */
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: var(--spacing-xl);
        margin: var(--spacing-xl) 0;
        padding: 0 var(--spacing-sm);
    }

    .feature-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-xl);
        text-align: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transform-origin: center;
    }

    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.6s ease;
    }

    .feature-card:hover::before {
        left: 100%;
    }

    .feature-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: var(--primary-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }

    .feature-icon {
        font-size: 3rem;
        margin-bottom: var(--spacing-md);
        display: inline-block;
        transition: all 0.4s ease;
    }

    .feature-card:hover .feature-icon {
        transform: scale(1.1) rotate(5deg);
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
    }

    /* Enhanced Visual Effects and Modern Styling */
    
    /* Advanced gradient backgrounds */
    .weather-widget-enhanced {
        background: linear-gradient(135deg, 
            rgba(59, 130, 246, 0.15) 0%, 
            rgba(147, 51, 234, 0.1) 50%,
            rgba(59, 130, 246, 0.05) 100%
        );
        border: 2px solid rgba(59, 130, 246, 0.2);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }
    
    .weather-widget-enhanced::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.1) 2px, transparent 2px),
                    radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.08) 3px, transparent 3px);
        background-size: 50px 50px, 80px 80px;
        animation: floatingPattern 20s linear infinite;
        opacity: 0.6;
        pointer-events: none;
    }
    
    .light-theme .weather-widget-enhanced {
        background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.95) 0%, 
            rgba(248, 250, 252, 0.9) 50%,
            rgba(239, 246, 255, 0.95) 100%
        );
        border: 2px solid rgba(59, 130, 246, 0.15);
    }
    
    /* Enhanced feature cards with micro-interactions */
    .feature-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-xl);
        text-align: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transform-origin: center;
    }
    
    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.6s ease;
    }
    
    .feature-card:hover::before {
        left: 100%;
    }
    
    .feature-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: var(--primary-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .feature-icon {
        font-size: 3rem;
        margin-bottom: var(--spacing-md);
        display: inline-block;
        transition: all 0.4s ease;
    }
    
    .feature-card:hover .feature-icon {
        transform: scale(1.1) rotate(5deg);
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
    }
    
    /* Enhanced prayer item styling */
    .prayer-item-enhanced {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 2px solid rgba(255, 255, 255, 0.1);
        position: relative;
        overflow: hidden;
    }
    
    .prayer-item-enhanced::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .prayer-item-enhanced:hover::before {
        opacity: 1;
    }
    
    .prayer-item-enhanced.next-prayer {
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.15);
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        animation: nextPrayerGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes nextPrayerGlow {
        from {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        to {
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
        }
    }
    
    /* Enhanced weather detail items */
    .weather-detail-item {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        cursor: pointer;
    }
    
    .weather-detail-item:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    
    .weather-detail-icon {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        display: block;
        transition: all 0.3s ease;
    }
    
    .weather-detail-item:hover .weather-detail-icon {
        transform: scale(1.2);
        filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
    }
    
    /* Enhanced buttons with ripple effect */
    .weather-action-btn, .prayer-action-btn {
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .weather-action-btn::before, .prayer-action-btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.3s ease, height 0.3s ease;
    }
    
    .weather-action-btn:active::before, .prayer-action-btn:active::before {
        width: 200px;
        height: 200px;
    }
    
    /* Enhanced loading states */
    .loading-weather, .loading-prayer-times {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 2px dashed rgba(255, 255, 255, 0.2);
    }
    
    .loading-weather i, .loading-prayer-times i {
        font-size: 2rem;
        color: var(--primary-color);
        animation: pulse 1.5s ease-in-out infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 0.5; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.1); }
    }
    
    /* Enhanced modal styling */
    .modal-overlay {
        backdrop-filter: blur(8px);
        transition: all 0.3s ease;
    }
    
    .modal-content {
        animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translate(-50%, -60%) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
    }
    
    /* Enhanced stats with counters */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
    }
    
    .stat-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, var(--primary-color), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .stat-card:hover::before {
        opacity: 0.1;
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        position: relative;
        z-index: 1;
    }
    
    .stat-label {
        color: var(--text-muted);
        font-weight: 600;
        position: relative;
        z-index: 1;
    }
    
    /* Floating effect for weather and prayer items */
    @keyframes floatingPattern {
        0% { transform: translateX(0) translateY(0); }
        33% { transform: translateX(10px) translateY(-10px); }
        66% { transform: translateX(-5px) translateY(5px); }
        100% { transform: translateX(0) translateY(0); }
    }
    
    /* Responsive Design Enhancements */
    @media (max-width: 768px) {
        .prayer-grid-enhanced {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }
        
        .weather-details {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .feature-card {
            padding: 1.5rem;
        }
        
        .modal-content {
            width: 95%;
            margin: 5% auto;
        }
    }
    
    @media (max-width: 480px) {
        .prayer-grid-enhanced {
            grid-template-columns: 1fr;
        }
        
        .weather-details {
            grid-template-columns: 1fr;
        }
        
        .feature-icon {
            font-size: 2.5rem;
        }
        
        .stat-number {
            font-size: 2rem;
        }
    }

    /* Enhanced Visual Effects and Modern Styling */
    
    /* Advanced gradient backgrounds */
    .weather-widget-enhanced {
        background: linear-gradient(135deg, 
            rgba(59, 130, 246, 0.15) 0%, 
            rgba(147, 51, 234, 0.1) 50%,
            rgba(59, 130, 246, 0.05) 100%
        );
        border: 2px solid rgba(59, 130, 246, 0.2);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }
    
    .weather-widget-enhanced::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.1) 2px, transparent 2px),
                    radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.08) 3px, transparent 3px);
        background-size: 50px 50px, 80px 80px;
        animation: floatingPattern 20s linear infinite;
        opacity: 0.6;
        pointer-events: none;
    }
    
    .light-theme .weather-widget-enhanced {
        background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.95) 0%, 
            rgba(248, 250, 252, 0.9) 50%,
            rgba(239, 246, 255, 0.95) 100%
        );
        border: 2px solid rgba(59, 130, 246, 0.15);
    }
    
    /* Enhanced feature cards with micro-interactions */
    .feature-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-xl);
        text-align: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transform-origin: center;
    }
    
    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.6s ease;
    }
    
    .feature-card:hover::before {
        left: 100%;
    }
    
    .feature-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: var(--primary-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .feature-icon {
        font-size: 3rem;
        margin-bottom: var(--spacing-md);
        display: inline-block;
        transition: all 0.4s ease;
    }
    
    .feature-card:hover .feature-icon {
        transform: scale(1.1) rotate(5deg);
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
    }
    
    /* Enhanced prayer item styling */
    .prayer-item-enhanced {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 2px solid rgba(255, 255, 255, 0.1);
        position: relative;
        overflow: hidden;
    }
    
    .prayer-item-enhanced::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .prayer-item-enhanced:hover::before {
        opacity: 1;
    }
    
    .prayer-item-enhanced.next-prayer {
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.15);
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        animation: nextPrayerGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes nextPrayerGlow {
        from {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        to {
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
        }
    }
    
    /* Enhanced weather detail items */
    .weather-detail-item {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        cursor: pointer;
    }
    
    .weather-detail-item:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    
    .weather-detail-icon {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        display: block;
        transition: all 0.3s ease;
    }
    
    .weather-detail-item:hover .weather-detail-icon {
        transform: scale(1.2);
        filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
    }
    
    /* Enhanced buttons with ripple effect */
    .weather-action-btn, .prayer-action-btn {
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .weather-action-btn::before, .prayer-action-btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.3s ease, height 0.3s ease;
    }
    
    .weather-action-btn:active::before, .prayer-action-btn:active::before {
        width: 200px;
        height: 200px;
    }
    
    /* Enhanced loading states */
    .loading-weather, .loading-prayer-times {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 2px dashed rgba(255, 255, 255, 0.2);
    }
    
    .loading-weather i, .loading-prayer-times i {
        font-size: 2rem;
        color: var(--primary-color);
        animation: pulse 1.5s ease-in-out infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 0.5; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.1); }
    }
    
    /* Enhanced modal styling */
    .modal-overlay {
        backdrop-filter: blur(8px);
        transition: all 0.3s ease;
    }
    
    .modal-content {
        animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translate(-50%, -60%) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
    }
    
    /* Enhanced stats with counters */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
    }
    
    .stat-card {
        background: var(--card-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius-lg);
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, var(--primary-color), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .stat-card:hover::before {
        opacity: 0.1;
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        position: relative;
        z-index: 1;
    }
    
    .stat-label {
        color: var(--text-muted);
        font-weight: 600;
        position: relative;
        z-index: 1;
    }
    
    /* Floating effect for weather and prayer items */
    @keyframes floatingPattern {
        0% { transform: translateX(0) translateY(0); }
        33% { transform: translateX(10px) translateY(-10px); }
        66% { transform: translateX(-5px) translateY(5px); }
        100% { transform: translateX(0) translateY(0); }
    }
    
    /* Responsive Design Enhancements */
    @media (max-width: 768px) {
        .prayer-grid-enhanced {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }
        
        .weather-details {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .feature-card {
            padding: 1.5rem;
        }
        
        .modal-content {
            width: 95%;
            margin: 5% auto;
        }
    }
    
    @media (max-width: 480px) {
        .prayer-grid-enhanced {
            grid-template-columns: 1fr;
        }
        
        .weather-details {
            grid-template-columns: 1fr;
        }
        
        .feature-icon {
            font-size: 2.5rem;
        }
        
        .stat-number {
            font-size: 2rem;
        }
    }

    /* ...existing CSS... */
</style>
{% endblock %}

{% block content %}
<div class="islamic-pattern"></div>

<!-- Random Hadith Banner -->
<div class="hadith-banner">
    <div class="hadith-content">
        <div class="hadith-arabic">{{ random_hadith.arabic }}</div>
        <div class="hadith-translation">"{{ random_hadith.translation }}"</div>
        <div class="hadith-narrator">{{ random_hadith.narrator }}</div>
    </div>
</div>

<!-- Hero Section -->
<div class="hero-section">
    <h1 class="hero-title">التطبيق الإسلامي الشامل</h1>
    <p class="hero-subtitle">
        مرحباً بك في التطبيق الإسلامي الشامل - رفيقك في رحلتك الروحانية
        <br>
        Welcome to the Complete Islamic App - Your companion in your spiritual journey
    </p>
</div>

<!-- Enhanced User Stats Section (if logged in) -->
<div class="stats-section">
    <h2 class="stats-title">📊 إحصائياتك الروحانية</h2>
    <div class="enhanced-stats-grid">
        <div class="stat-card daily-progress">
            <div class="stat-icon">📿</div>
            <div class="stat-content">
                <div id="totalDhikrCount" class="stat-number">0</div>
                <div class="stat-label">إجمالي التسبيحات</div>
                <div class="stat-progress">
                    <div class="progress-bar" id="dhikrProgress"></div>
                </div>
            </div>
        </div>
        
        <div class="stat-card prayer-consistency">
            <div class="stat-icon">🕌</div>
            <div class="stat-content">
                <div id="prayerStreak" class="stat-number">{{ day_streak if day_streak else 0 }}</div>
                <div class="stat-label">أيام متتالية</div>
                <div class="streak-indicator" id="streakIndicator">
                    <span class="flame">🔥</span>
                </div>
            </div>
        </div>
        
        <div class="stat-card today-activity">
            <div class="stat-icon">🌅</div>
            <div class="stat-content">
                <div id="todayDhikr" class="stat-number">0</div>
                <div class="stat-label">تسبيحات اليوم</div>
                <div class="daily-goal">
                    <small>الهدف: <span id="dailyGoal">100</span></small>
                </div>
            </div>
        </div>
        
        <div class="stat-card spiritual-level">
            <div class="stat-icon">⭐</div>
            <div class="stat-content">
                <div id="spiritualLevel" class="stat-number">1</div>
                <div class="stat-label">المستوى الروحاني</div>
                <div class="level-badge" id="levelBadge">مبتدئ</div>
            </div>
        </div>
        
        <div class="stat-card quran-progress">
            <div class="stat-icon">📖</div>
            <div class="stat-content">
                <div id="quranProgress" class="stat-number">0</div>
                <div class="stat-label">آيات تُليت</div>
                <div class="quran-milestone">
                    <small>التالي: <span id="nextMilestone">جزء عم</span></small>
                </div>
            </div>
        </div>
        
        <div class="stat-card weekly-summary">
            <div class="stat-icon">📊</div>
            <div class="stat-content">
                <div id="weeklyAverage" class="stat-number">0</div>
                <div class="stat-label">معدل أسبوعي</div>
                <div class="trend-indicator" id="trendIndicator">
                    <span class="trend-up">↗️</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Enhanced Prayer Times Widget -->
<div class="prayer-times-enhanced-widget">
    <div class="prayer-widget-header">
        <h3><i class="fas fa-mosque"></i> مواقيت الصلاة</h3>
        <div class="location-info" id="currentLocation">
            <i class="fas fa-map-marker-alt"></i> <span id="locationText">جاري التحديد...</span>
        </div>
    </div>
    
    <!-- Next Prayer Indicator -->
    <div class="next-prayer-card" id="nextPrayerCard">
        <div class="next-prayer-header">
            <i class="fas fa-clock"></i> الصلاة القادمة
        </div>
        <div class="next-prayer-content">
            <div class="next-prayer-name" id="nextPrayerName">الفجر</div>
            <div class="next-prayer-time" id="nextPrayerTime">05:30</div>
            <div class="next-prayer-countdown" id="nextPrayerCountdown">متبقي: 3:24:15</div>
        </div>
    </div>
    
    <!-- Prayer Times Grid -->
    <div class="prayer-grid-enhanced" id="prayerTimesContent">
        <div class="loading-prayer-times">
            <i class="fas fa-spinner fa-spin"></i> جاري تحميل المواقيت...
        </div>
    </div>
    
    <!-- Prayer Actions -->
    <div class="prayer-actions">
        <button class="prayer-action-btn" id="detectLocationBtnHome">
            <i class="fas fa-crosshairs"></i> تحديد موقعي
        </button>
        <button class="prayer-action-btn" onclick="toggleNotifications()">
            <i class="fas fa-bell"></i> التنبيهات
        </button>
        <a href="{{ url_for('prayer_times') }}" class="prayer-action-btn primary">
            <i class="fas fa-expand"></i> عرض تفصيلي
        </a>
    </div>
</div>

<!-- Enhanced Weather Widget -->
<div class="weather-widget-enhanced">
    <div class="weather-header">
        <h3><i class="fas fa-cloud-sun"></i> حالة الطقس</h3>
        <div class="weather-location" id="weatherLocation">
            <i class="fas fa-map-marker-alt"></i> <span id="weatherLocationText">جاري التحديد...</span>
        </div>
    </div>
    
    <div class="weather-content" id="weatherContent">
        <div class="loading-weather">
            <i class="fas fa-spinner fa-spin"></i> جاري تحميل بيانات الطقس...
        </div>
    </div>
    
    <div class="weather-forecast" id="weatherForecast" style="display: none;">
        <h4><i class="fas fa-calendar-week"></i> توقعات الأيام القادمة</h4>
        <div class="forecast-grid" id="forecastGrid">
            <!-- Forecast items will be loaded here -->
        </div>
    </div>
    
    <div class="weather-actions">
        <button class="weather-action-btn" id="refreshWeatherBtn">
            <i class="fas fa-sync-alt"></i> تحديث
        </button>
        <button class="weather-action-btn" id="weatherSettingsBtn">
            <i class="fas fa-cog"></i> الإعدادات
        </button>
    </div>
</div>

<!-- Weather Settings Modal -->
<div class="modal-overlay" id="weatherSettingsModal" style="display: none;">
    <div class="modal-content weather-settings-modal">
        <div class="modal-header">
            <h3><i class="fas fa-cog"></i> إعدادات الطقس</h3>
            <button class="modal-close" onclick="closeWeatherSettings()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <div class="settings-section">
                <h4><i class="fas fa-thermometer-half"></i> وحدة الحرارة</h4>
                <div class="setting-group">
                    <label class="setting-radio">
                        <input type="radio" name="tempUnit" value="celsius" checked>
                        <span class="radio-custom"></span>
                        مئوية (°C)
                    </label>
                    <label class="setting-radio">
                        <input type="radio" name="tempUnit" value="fahrenheit">
                        <span class="radio-custom"></span>
                        فهرنهايت (°F)
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h4><i class="fas fa-wind"></i> وحدة سرعة الرياح</h4>
                <div class="setting-group">
                    <label class="setting-radio">
                        <input type="radio" name="windUnit" value="kmh" checked>
                        <span class="radio-custom"></span>
                        كيلومتر/ساعة
                    </label>
                    <label class="setting-radio">
                        <input type="radio" name="windUnit" value="mph">
                        <span class="radio-custom"></span>
                        ميل/ساعة
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h4><i class="fas fa-clock"></i> تنسيق الوقت</h4>
                <div class="setting-group">
                    <label class="setting-radio">
                        <input type="radio" name="timeFormat" value="24h" checked>
                        <span class="radio-custom"></span>
                        24 ساعة
                    </label>
                    <label class="setting-radio">
                        <input type="radio" name="timeFormat" value="12h">
                        <span class="radio-custom"></span>
                        12 ساعة
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h4><i class="fas fa-map-marker-alt"></i> الموقع</h4>
                <div class="setting-group">
                    <label class="setting-toggle">
                        <input type="checkbox" id="useLocationToggle" checked>
                        <span class="toggle-slider"></span>
                        استخدام الموقع الحالي
                    </label>
                </div>
                <div class="location-input" id="locationInput" style="display: none;">
                    <input type="text" placeholder="ادخل اسم المدينة..." id="cityNameInput">
                    <button onclick="searchLocation()" class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <h4><i class="fas fa-calendar-week"></i> التوقعات</h4>
                <div class="setting-group">
                    <label class="setting-toggle">
                        <input type="checkbox" id="showForecastToggle" checked>
                        <span class="toggle-slider"></span>
                        عرض توقعات الأيام القادمة
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h4><i class="fas fa-sync-alt"></i> التحديث التلقائي</h4>
                <div class="setting-group">
                    <label class="setting-toggle">
                        <input type="checkbox" id="autoRefreshToggle" checked>
                        <span class="toggle-slider"></span>
                        تحديث تلقائي كل 30 دقيقة
                    </label>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn-primary" onclick="saveWeatherSettings()">
                <i class="fas fa-save"></i> حفظ الإعدادات
            </button>
            <button class="btn-secondary" onclick="resetWeatherSettings()">
                <i class="fas fa-undo"></i> إعادة تعيين
            </button>
        </div>
    </div>
</div>

<!-- Islamic Features Dashboard -->
<div class="islamic-dashboard">
    <!-- Time-based Islamic Reminders -->
    <div class="time-based-reminders">
        <h3>🕐 تذكيرات بناءً على الوقت</h3>
        <div class="reminder-cards">
            <div class="reminder-card" id="currentReminder">
                <div class="reminder-icon">🌅</div>
                <div class="reminder-text">حان وقت أذكار الصباح</div>
                <button class="reminder-btn" onclick="showMorningAdhkar()">ابدأ الآن</button>
            </div>
        </div>
    </div>

    <!-- Quick Islamic Actions -->
    <div class="quick-islamic-actions">
        <h3>⚡ عبادات سريعة</h3>
        <div class="actions-grid">
            <div class="action-item" onclick="quickSalawat()">
                <div class="action-icon">🤲</div>
                <div class="action-text">صلاة على النبي</div>
                <div class="action-count" id="salawatCount">0</div>
            </div>
            
            <div class="action-item" onclick="quickIstighfar()">
                <div class="action-icon">🕊️</div>
                <div class="action-text">استغفار سريع</div>
                <div class="action-count" id="istighfarCount">0</div>
            </div>
            
            <div class="action-item" onclick="quickSubhanAllah()">
                <div class="action-icon">✨</div>
                <div class="action-text">سبحان الله</div>
                <div class="action-count" id="subhanCount">0</div>
            </div>
            
            <div class="action-item" onclick="quickAlhamdulillah()">
                <div class="action-icon">🙏</div>
                <div class="action-text">الحمد لله</div>
                <div class="action-count" id="alhamdCount">0</div>
            </div>
        </div>
    </div>

    <!-- Islamic Calendar Integration -->
    <div class="islamic-calendar-widget">
        <h3>📅 التقويم الهجري والمناسبات</h3>
        <div class="calendar-content">
            <div class="hijri-date">
                <div class="hijri-day" id="hijriDay">1</div>
                <div class="hijri-month" id="hijriMonth">محرم</div>
                <div class="hijri-year" id="hijriYear">1446</div>
            </div>
            <div class="islamic-events">
                <div class="event-item" id="upcomingEvent">
                    <div class="event-icon">🌙</div>
                    <div class="event-text">ليلة القدر قريباً</div>
                    <div class="event-days">بعد 15 يوم</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quran Verse of the Day -->
    <div class="verse-of-the-day">
        <h3>📖 آية اليوم</h3>
        <div class="verse-container" id="verseOfDay">
            <div class="verse-arabic">وَاذْكُر رَّبَّكَ إِذَا نَسِيتَ</div>
            <div class="verse-translation">And remember your Lord when you forget</div>
            <div class="verse-reference">سورة الكهف - آية 24</div>
            <button class="verse-btn" onclick="getNewVerse()">آية جديدة</button>
        </div>
    </div>

    <!-- Dua Request Feature -->
    <div class="dua-requests">
        <h3>🤲 طلب دعاء</h3>
        <div class="dua-container">
            <textarea class="dua-input" id="duaInput" placeholder="اكتب دعاءك هنا وسيدعو لك المسلمون حول العالم..."></textarea>
            <button class="dua-submit-btn" onclick="submitDua()">أرسل طلب الدعاء</button>
            <div class="dua-counter">
                <span id="duaCount">0</span> مسلم يدعو لك الآن 🤲
            </div>
        </div>
    </div>
</div>

<!-- Features Grid -->
<div class="features-grid">
    <div class="feature-card">
        <div class="feature-icon">📿</div>
        <h3 class="feature-title">التسبيح الرقمي</h3>
        <p class="feature-description">
            سبّح الله واحتفظ بإحصائياتك اليومية والشهرية مع تتبع تقدمك الروحاني
        </p>
        <a href="{{ url_for('tasbeh') }}" class="feature-link">
            <i class="fas fa-arrow-left"></i> ابدأ التسبيح
        </a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">🕌</div>
        <h3 class="feature-title">مواقيت الصلاة</h3>
        <p class="feature-description">
            تابع أوقات الصلاة لموقعك مع تنبيهات وإحصائيات شهرية دقيقة
        </p>
        <a href="{{ url_for('prayer_times') }}" class="feature-link">
            <i class="fas fa-arrow-left"></i> مشاهدة المواقيت
        </a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">📖</div>
        <h3 class="feature-title">القرآن الكريم</h3>
        <p class="feature-description">
            اقرأ واستمع للقرآن الكريم مع ترجمات وتفاسير متعددة
        </p>
        <a href="{{ url_for('quran') }}" class="feature-link">
            <i class="fas fa-arrow-left"></i> قراءة القرآن
        </a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">🕋</div>
        <h3 class="feature-title">الأحاديث الشريفة</h3>
        <p class="feature-description">
            اطلع على مجموعة شاملة من الأحاديث النبوية الصحيحة من مختلف المصادر
        </p>
        <a href="{{ url_for('hadith') }}" class="feature-link">
            <i class="fas fa-arrow-left"></i> تصفح الأحاديث
        </a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">💭</div>
        <h3 class="feature-title">عباراتي المخصصة</h3>
        <p class="feature-description">
            أضف عباراتك وأذكارك المفضلة وخصص تجربتك الروحانية
        </p>
        <a href="{{ url_for('my_phrases') }}" class="feature-link">
            <i class="fas fa-arrow-left"></i> إدارة العبارات
        </a>
    </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions">
    <div class="action-card">
        <h4>🌅 تسبيح سريع</h4>
        <button class="dhikr-counter" onclick="quickDhikr()">
            <span id="quickCount">0</span>
        </button>
        <p>اضغط للتسبيح السريع</p>
    </div>

    <div class="action-card">
        <h4>🎲 آية عشوائية</h4>
        <button class="btn btn-primary" onclick="getRandomVerse()">
            <i class="fas fa-random"></i> آية جديدة
        </button>
        <div id="randomVerse" style="margin-top: 1rem; display: none;"></div>
    </div>
</div>

<!-- Prayer Settings Modal -->
<div class="modal-overlay" id="prayerSettingsModal" style="display: none;">
    <div class="modal-content" style="background: rgba(0, 0, 0, 0.8); color: white; border-radius: 12px; padding: 2rem;">
        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h3 style="margin: 0; font-size: 1.5rem; font-family: 'Amiri', serif;">إعدادات التنبيهات</h3>
            <button class="modal-close" id="closePrayerSettingsBtn" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
            <div class="prayer-notification-item">
                <div class="prayer-notification-label" style="flex: 1;">
                    <i class="fas fa-salah" style="color: #ffd700;"></i>
                    <span>صلاة الفجر</span>
                </div>
                <div class="prayer-toggle-switch" data-prayer="fajr">
                    <div class="prayer-toggle-slider"></div>
                </div>
            </div>
            
            <div class="prayer-notification-item">
                <div class="prayer-notification-label" style="flex: 1;">
                    <i class="fas fa-salah" style="color: #ffd700;"></i>
                    <span>صلاة الظهر</span>
                </div>
                <div class="prayer-toggle-switch" data-prayer="dhuhr">
                    <div class="prayer-toggle-slider"></div>
                </div>
            </div>
            
            <div class="prayer-notification-item">
                <div class="prayer-notification-label" style="flex: 1;">
                    <i class="fas fa-salah" style="color: #ffd700;"></i>
                    <span>صلاة العصر</span>
                </div>
                <div class="prayer-toggle-switch" data-prayer="asr">
                    <div class="prayer-toggle-slider"></div>
                </div>
            </div>
            
            <div class="prayer-notification-item">
                <div class="prayer-notification-label" style="flex: 1;">
                    <i class="fas fa-salah" style="color: #ffd700;"></i>
                    <span>صلاة المغرب</span>
                </div>
                <div class="prayer-toggle-switch" data-prayer="maghrib">
                    <div class="prayer-toggle-slider"></div>
                </div>
            </div>
            
            <div class="prayer-notification-item">
                <div class="prayer-notification-label" style="flex: 1;">
                    <i class="fas fa-salah" style="color: #ffd700;"></i>
                    <span>صلاة العشاء</span>
                </div>
                <div class="prayer-toggle-switch" data-prayer="isha">
                    <div class="prayer-toggle-slider"></div>
                </div>
            </div>
        </div>

        <div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 1rem; margin-top: 1.5rem;">
            <button class="btn-primary" id="savePrayerSettingsBtn" style="padding: 0.8rem 1.5rem; border-radius: 25px; font-weight: 600; cursor: pointer;">
                <i class="fas fa-save"></i> حفظ الإعدادات
            </button>
            <button class="btn-secondary" onclick="toggleNotifications()" style="padding: 0.8rem 1.5rem; border-radius: 25px; font-weight: 600; cursor: pointer;">
                <i class="fas fa-times"></i> إغلاق
            </button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    let quickCounter = 0;
    let salawatCounter = 0;
    let istighfarCounter = 0;
    let subhanCounter = 0;
    let alhamdCounter = 0;
    let duaCount = Math.floor(Math.random() * 1000) + 100; // Random starting count

    // Enhanced stats tracking
    let todayDhikr = 0;
    let weeklyTotal = 0;
    let spiritualLevel = 1;

    // Quick dhikr functionality
    function quickDhikr() {
        quickCounter++;
        todayDhikr++;
        document.getElementById('quickCount').textContent = quickCounter;
        updateTodayStats();
        
        // Add visual feedback
        const button = document.querySelector('.dhikr-counter');
        button.style.transform = 'scale(1.2)';
        setTimeout(() => {
            button.style.transform = 'scale(1)';
        }, 150);
    }

    // Quick Islamic Actions
    function quickSalawat() {
        salawatCounter++;
        todayDhikr++;
        document.getElementById('salawatCount').textContent = salawatCounter;
        updateTodayStats();
        animateAction('salawat');
        sendDhikrToServer('اللهم صل على سيدنا محمد');
    }

    function quickIstighfar() {
        istighfarCounter++;
        todayDhikr++;
        document.getElementById('istighfarCount').textContent = istighfarCounter;
        updateTodayStats();
        animateAction('istighfar');
        sendDhikrToServer('أستغفر الله');
    }

    function quickSubhanAllah() {
        subhanCounter++;
        todayDhikr++;
        document.getElementById('subhanCount').textContent = subhanCounter;
        updateTodayStats();
        animateAction('subhan');
        sendDhikrToServer('سبحان الله');
    }

    function quickAlhamdulillah() {
        alhamdCounter++;
        todayDhikr++;
        document.getElementById('alhamdCount').textContent = alhamdCounter;
        updateTodayStats();
        animateAction('alhamd');
        sendDhikrToServer('الحمد لله');
    }

    function animateAction(type) {
        const element = event.target.closest('.action-item');
        element.style.transform = 'scale(1.1)';
        element.style.borderColor = '#ffd700';
        setTimeout(() => {
            element.style.transform = 'scale(1)';

            element.style.borderColor = '';
        }, 300);
    }

    // Send dhikr to server for tracking
    function sendDhikrToServer(phrase) {
        fetch('/increment-dhikr', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({phrase: phrase, amount: 1})
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTotalDhikr();
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Update today's stats
    function updateTodayStats() {
        todayDhikr++;
        document.getElementById('alhamdCount').textContent = alhamdCounter;
        updateTodayStats();
        animateAction('alhamd');
        sendDhikrToServer('الحمد لله');
    }

    function animateAction(type) {
        const element = event.target.closest('.action-item');
        element.style.transform = 'scale(1.1)';
        element.style.borderColor = '#ffd700';
        setTimeout(() => {
            element.style.transform = 'scale(1)';

            element.style.borderColor = '';
        }, 300);
    }

    // Send dhikr to server for tracking
    function sendDhikrToServer(phrase) {
        fetch('/increment-dhikr', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({phrase: phrase, amount: 1})
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTotalDhikr();
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Update today's stats
    function updateTodayStats() {
        document.getElementById('todayDhikr').textContent = todayDhikr;
        
        // Update progress bar
        const dailyGoal = 100;
        const progress = Math.min((todayDhikr / dailyGoal) * 100, 100);
        document.getElementById('dhikrProgress').style.width = progress + '%';
        
        // Update spiritual level
        const newLevel = Math.floor(todayDhikr / 50) + 1;
        if (newLevel !== spiritualLevel) {
            spiritualLevel = newLevel;
            updateSpiritualLevel();
        }
    }

    function updateSpiritualLevel() {
        document.getElementById('spiritualLevel').textContent = spiritualLevel;
        const badges = ['مبتدئ', 'متوسط', 'متقدم', 'خبير', 'عالم', 'شيخ'];
        const badgeIndex = Math.min(spiritualLevel - 1, badges.length - 1);
        document.getElementById('levelBadge').textContent = badges[badgeIndex];
    }

    // Get random verse functionality (enhanced)
    async function getRandomVerse() {
        try {
            const response = await fetch('/api/quran/random');
            const data = await response.json();
            
            if (data.success) {
                const verse = data.data;
                const verseElement = document.getElementById('randomVerse');
                verseElement.innerHTML = `
                    <div style="background: var(--card-bg); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <div style="font-family: 'Amiri', serif; font-size: 1.2rem; color: var(--text-color); margin-bottom: 0.5rem;">
                            ${verse.ayah.text}
                        </div>
                        <div style="color: var(--text-muted); font-size: 0.9rem;">
                            ${verse.surah.name} - الآية ${verse.ayah.number}
                        </div>
                    </div>
                `;
                verseElement.style.display = 'block';
            }
        } catch (error) {
            console.error('Error fetching random verse:', error);
        }
    }

    // New verse for verse of the day
    async function getNewVerse() {
        try {
            const response = await fetch('/api/quran/random');
            const data = await response.json();
            
            if (data.success) {
                const verse = data.data;
                document.querySelector('.verse-arabic').textContent = verse.ayah.text;
                document.querySelector('.verse-translation').textContent = `"${verse.ayah.text}"`; // In real app, get translation
                document.querySelector('.verse-reference').textContent = `${verse.surah.name} - آية ${verse.ayah.number}`;
            }
        } catch (error) {
            console.error('Error fetching new verse:', error);
        }
    }

    // Dua submission
    function submitDua() {
        const duaText = document.getElementById('duaInput').value.trim();
        if (duaText) {
            // Simulate adding to global dua list
            duaCount += Math.floor(Math.random() * 10) + 1;
            document.getElementById('duaCount').textContent = duaCount;
            
            // Clear input and show success
            document.getElementById('duaInput').value = '';
            showNotification('تم إرسال طلب الدعاء بنجاح! 🤲');
            
            // Animate counter
            const counter = document.querySelector('.dua-counter');
            counter.style.animation = 'none';
            setTimeout(() => {
                counter.style.animation = 'glow 2s ease-in-out infinite';
            }, 100);
        }
    }

    // Show notifications
    function showNotification(message) {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #22c55e, #16a34a);
            color: white;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    // Morning/Evening Adhkar
    function showMorningAdhkar() {
        const adhkar = [
            'أصبحنا وأصبح الملك لله',
            'اللهم بك أصبحنا وبك أمسينا',
            'سبحان الله وبحمده',
            'أعوذ بالله من الشيطان الرجيم'
        ];
        
        let currentIndex = 0;
        const interval = setInterval(() => {
            if (currentIndex < adhkar.length) {
                showNotification(adhkar[currentIndex]);
                currentIndex++;
            } else {
                clearInterval(interval);
                showNotification('انتهت أذكار الصباح 🌅');
            }
        }, 2000);
    }

    // Update time-based reminders
    function updateTimeBasedReminders() {
        const now = new Date();
        const hour = now.getHours();
        
        let reminderText = '';
        let reminderIcon = '';
        let action = '';
        
        if (hour >= 6 && hour < 12) {
            reminderText = 'حان وقت أذكار الصباح';
            reminderIcon = '🌅';
            action = 'showMorningAdhkar()';
        } else if (hour >= 12 && hour < 15) {
            reminderText = 'وقت الذكر بعد صلاة الظهر';
            reminderIcon = '☀️';
            action = 'quickDhikr()';
        } else if (hour >= 15 && hour < 18) {
            reminderText = 'اقرأ شيئاً من القرآن';
            reminderIcon = '📖';
            action = 'window.location.href="/quran"';
        } else if (hour >= 18 && hour < 21) {
            reminderText = 'حان وقت أذكار المساء';
            reminderIcon = '🌅';
            action = 'showEveningAdhkar()';
        } else {
            reminderText = 'وقت التسبيح والذكر';
            reminderIcon = '🌙';
            action = 'quickDhikr()';
        }
        
        document.querySelector('.reminder-icon').textContent = reminderIcon;
        document.querySelector('.reminder-text').textContent = reminderText;
        document.querySelector('.reminder-btn').setAttribute('onclick', action);
    }

    // Update Hijri date
    function updateHijriDate() {
        // Simplified Hijri date (in real app, use proper conversion)
        const gregorianDate = new Date();
        const hijriMonths = [
            'محرم', 'صفر', 'ربيع الأول', 'ربيع الثاني', 'جمادى الأولى', 'جمادى الثانية',
            'رجب', 'شعبان', 'رمضان', 'شوال', 'ذو القعدة', 'ذو الحجة'
        ];
        
        const hijriDay = gregorianDate.getDate();
        const hijriMonth = hijriMonths[gregorianDate.getMonth()];
        const hijriYear = 1446; // Approximate
        
        document.getElementById('hijriDay').textContent = hijriDay;
        document.getElementById('hijriMonth').textContent = hijriMonth;
        document.getElementById('hijriYear').textContent = hijriYear;
    }

    // Update total dhikr count
    function updateTotalDhikr() {
        fetch('/get-total-dhikr')
        .then(response => response.json())
        .then(data => {
            document.getElementById('totalDhikrCount').textContent = data.total;
            
            // Update weekly average (simplified)
            weeklyTotal = data.total;
            const weeklyAverage = Math.floor(weeklyTotal / 7);
            document.getElementById('weeklyAverage').textContent = weeklyAverage;
        })
        .catch(error => {
            console.error('Error fetching total dhikr:', error);
            document.getElementById('totalDhikrCount').textContent = '0';
        });
    }

    // Enhanced Weather Widget animations
    function addWeatherAnimations() {
        const weatherWidget = document.querySelector('.weather-widget-enhanced');
        if (weatherWidget) {
            // Add floating animation to weather elements
            const weatherDetails = weatherWidget.querySelectorAll('.weather-detail-item');
            weatherDetails.forEach((item, index) => {
                item.style.animationDelay = `${index * 0.1}s`;
                item.classList.add('weather-detail-float');
            });
            
            // Add hover effects
            weatherWidget.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px) scale(1.02)';
                this.style.boxShadow = '0 20px 40px rgba(0, 0, 0, 0.2)';
            });
            
            weatherWidget.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.boxShadow = '0 10px 30px rgba(0, 0, 0, 0.1)';
            });
        }
    }

    // Enhanced prayer times animations
    function addPrayerTimesAnimations() {
        const prayerWidget = document.querySelector('.prayer-times-enhanced-widget');
        if (prayerWidget) {
            // Add staggered animation to prayer items
            const prayerItems = prayerWidget.querySelectorAll('.prayer-item-enhanced');
            prayerItems.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    item.style.transition = 'all 0.6s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 100);
            });
            
            // Add pulse effect to next prayer
            setInterval(() => {
                const nextPrayer = prayerWidget.querySelector('.prayer-item-enhanced.next-prayer');
                if (nextPrayer) {
                    nextPrayer.style.transform = 'scale(1.05)';
                    setTimeout(() => {
                        nextPrayer.style.transform = 'scale(1)';
                    }, 500);
                }
            }, 3000);
        }
    }

    // Enhanced notification system
    function showEnhancedNotification(message, type = 'info', duration = 5000) {
        const notification = document.createElement('div');
        notification.className = `notification-enhanced notification-${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <div class="notification-icon">
                    ${type === 'success' ? '✅' : type === 'warning' ? '⚠️' : type === 'error' ? '❌' : 'ℹ️'}
                </div>
                <div class="notification-text">${message}</div>
                <button class="notification-close" onclick="this.parentElement.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Trigger animation
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
            notification.style.opacity = '1';
        }, 100);
        
        // Auto remove
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            notification.style.opacity = '0';
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, duration);
    }

    // Enhanced feature card interactions
    function enhanceFeatureCards() {
        const featureCards = document.querySelectorAll('.feature-card');
        featureCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px) scale(1.03)';
                this.style.boxShadow = '0 25px 50px rgba(0, 0, 0, 0.15)';
                
                // Add shimmer effect
                const shimmer = document.createElement('div');
                shimmer.className = 'card-shimmer';
                this.appendChild(shimmer);
                
                setTimeout(() => {
                    if (this.contains(shimmer)) {
                        this.removeChild(shimmer);
                    }
                }, 600);
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)';
            });
        });
    }

    // Enhanced stats counter animation
    function animateStatsCounters() {
        const statNumbers = document.querySelectorAll('.stat-number');
        statNumbers.forEach(stat => {
            const target = parseInt(stat.textContent);
            let current = 0;
            const increment = target / 50;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                stat.textContent = Math.floor(current);
            }, 30);
        });
    }

    // Enhanced weather refresh with better UX
    function enhancedWeatherRefresh() {
        const refreshBtn = document.getElementById('refreshWeatherBtn');
        if (refreshBtn) {
            const originalText = refreshBtn.innerHTML;
            
            // Add loading state
            refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري التحديث...';
            refreshBtn.disabled = true;
            refreshBtn.style.background = 'linear-gradient(45deg, #6b7280, #4b5563)';
            
            // Show progress indicator
            const progressBar = document.createElement('div');
            progressBar.className = 'refresh-progress';
            refreshBtn.appendChild(progressBar);
            
            // Simulate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress > 100) progress = 100;
                progressBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                }
            }, 200);
            
            // Call actual weather loading
            loadWeatherData();
            
            // Reset button after 3 seconds
            setTimeout(() => {
                refreshBtn.innerHTML = originalText;
                refreshBtn.disabled = false;
                refreshBtn.style.background = '';
                if (refreshBtn.contains(progressBar)) {
                    refreshBtn.removeChild(progressBar);
                }
                showEnhancedNotification('تم تحديث بيانات الطقس بنجاح', 'success');
            }, 3000);
        }
    }

    // Initialize all enhancements
    document.addEventListener('DOMContentLoaded', function() {
        // Add enhanced styles
        const enhancedStyles = document.createElement('style');
        enhancedStyles.textContent = `
            .weather-detail-float {
                animation: floatUp 0.8s ease-out forwards;
            }
            
            @keyframes floatUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .card-shimmer {
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
                animation: shimmer 0.6s ease-out;
                pointer-events: none;
            }
            
            @keyframes shimmer {
                0% { left: -100%; }
                100% { left: 100%; }
            }
            
            .notification-enhanced {
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--card-bg);
                border-radius: 12px;
                padding: 1rem;
                box-shadow: var(--shadow-strong);
                z-index: 1000;
                transform: translateX(100%);
                opacity: 0;
                transition: all 0.3s ease;
                max-width: 400px;
                border-left: 4px solid var(--primary-color);
            }
            
            .notification-enhanced.notification-success {
                border-left-color: #10b981;
            }
            
            .notification-enhanced.notification-warning {
                border-left-color: #f59e0b;
            }
            
            .notification-enhanced.notification-error {
                border-left-color: #ef4444;
            }
            
            .notification-content {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            
            .notification-icon {
                font-size: 1.2rem;
                flex-shrink: 0;
            }
            
            .notification-text {
                flex: 1;
                font-weight: 600;
            }
            
            .notification-close {
                background: none;
                border: none;
                color: var(--text-muted);
                cursor: pointer;
                padding: 0.2rem;
                border-radius: 50%;
                transition: all 0.2s ease;
            }
            
            .notification-close:hover {
                background: var(--border-color);
                color: var(--text-color);
            }
            
            .refresh-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 3px;
                background: linear-gradient(45deg, #10b981, #059669);
                border-radius: 0 0 8px 8px;
                transition: width 0.3s ease;
                width: 0%;
            }
        `;
        document.head.appendChild(enhancedStyles);
        
        // Initialize all enhancement functions
        setTimeout(() => {
            addWeatherAnimations();
            addPrayerTimesAnimations();
            enhanceFeatureCards();
            animateStatsCounters();
        }, 1000);
        
        // Override weather refresh button
        const refreshWeatherBtn = document.getElementById('refreshWeatherBtn');
        if (refreshWeatherBtn) {
            refreshWeatherBtn.removeEventListener('click', refreshWeather);
            refreshWeatherBtn.addEventListener('click', enhancedWeatherRefresh);
        }
    });

    // ...existing code...
</script>
{% endblock %}
